# 系统设计文档

## 状态管理设计

### Redux Store结构
- code: 当前编辑器内容、执行状态和结果
- history: 最近20条执行记录
- favorites: 用户收藏的代码片段
- theme: 界面主题模式
- server: 服务器连接配置

### 持久化策略
使用redux-persist实现：
- 主题模式：localStorage持久化
- 历史记录：localStorage存储最近20条
- 收藏夹：localStorage永久存储
- 服务器配置：localStorage存储URL

## 执行流程

1. 用户提交代码
2. 通过axios发送到/evaluate接口
3. 处理成功/失败结果
4. 更新Redux store
5. 持久化最新状态

## 新增功能实现

### 快捷命令支持（2024-05-20新增）
在package.json中扩展scripts字段：
- 开发服务器启动命令标准化
- 增加生产构建流程
- 添加预览生产版本命令
- 配套测试脚本验证构建产物

实现要点：
1. 利用Vite原生命令保证最佳实践
2. 组合命令实现构建+预览流程
3. 测试脚本验证关键路径

### UI空间优化（2024-06-15新增）
针对用户反馈的"UI空间利用不足"问题，进行以下改进：
1. 重构代码编辑器面板布局
   - 将操作按钮改为水平紧凑布局
   - 使用折叠式表单实现收藏功能
   - 优化网格系统空间分配
2. 响应式设计增强
   - 小屏幕保持垂直布局
   - 大屏幕使用更紧凑的设计
3. 功能整合
   - 将收藏表单整合到浮动按钮中
   - 使用Tooltip提供额外说明
4. 视觉优化
   - 减少不必要的边距和内边距
   - 使用更精细的网格间距

### 空间利用率增强（2024-06-XX新增）
针对用户反馈的"面板空间利用不足"问题，进行以下改进：
1. 布局优化
   - 移除最大宽度限制，充分利用浏览器宽度
   - 在大屏幕上增加代码编辑器占比（从7:5调整为9:3）
2. 自适应高度
   - 编辑器高度根据容器尺寸动态调整
   - 设置最小高度防止过度压缩
3. 响应式改进
   - 在中等屏幕上使用8:4比例
   - 在小屏幕上保持全宽垂直布局
4. 操作区域优化
   - 减少按钮间距
   - 使用紧凑布局节省空间

### 升级到Grid v2（2024-06-XX新增）
根据Material UI v7的升级指南，将Grid组件升级到v2版本：
1. 移除所有`item`属性（新版Grid默认所有网格都是item）
2. 使用新的`size`属性替代单独的断点属性（如xs, sm等）
3. 添加宽度设置解决容器默认不占满宽度的问题
4. 添加`disableEqualOverflow`属性保持负边距行为
5. 更新所有Grid布局组件使用新API

升级优势：
- 使用CSS变量提高样式灵活性
- 解决嵌套网格深度限制问题
- 消除旧版负边距导致的布局问题
- 更简洁的API设计